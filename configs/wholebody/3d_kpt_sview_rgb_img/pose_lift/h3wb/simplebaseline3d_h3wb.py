_base_ = [
    '../../../../_base_/default_runtime.py',
    '../../../../_base_/datasets/h3wb.py'
]
evaluation = dict(
    interval=10, 
    metric=['mpjpe', 'p-mpjpe'], 
    save_best='MPJPE')

# optimizer settings
optimizer = dict(
    type='Adam',
    lr=1e-3,
)
optimizer_config = dict(grad_clip=None)
# learning policy
lr_config = dict(
    policy='step',
    by_epoch=False,
    step=100000,
    gamma=0.96,
)

total_epochs = 200

channel_cfg = dict(
    num_output_channels=133,
    dataset_joints=133,
    dataset_channel=[
       list(range(133)),
    ],
    inference_channel=list(range(133)))

# model settings
model = dict(
    type='PoseLifter',
    pretrained=None,
    backbone=dict(
        type='TCN',
        in_channels=2 * 133,
        stem_channels=1024,
        num_blocks=4,
        kernel_sizes=(1, 1, 1, 1, 1),
        dropout=0.5),
    keypoint_head=dict(
        type='TemporalRegressionHead',
        in_channels=1024,
        num_joints=132,  # do not predict root joint
        loss_keypoint=dict(type='MSELoss')),
    train_cfg=dict(),
    test_cfg=dict(restore_global_position=True))

# data settings
data_root = 'data/h3wb'
data_cfg = dict(
    num_joints=133,
    seq_len=1,
    seq_frame_interval=1,
    causal=True,
    joint_2d_src='gt',
    need_camera_param=False,
    camera_param_file=f'{data_root}/annotations/cameras.pkl',
)

# 3D joint normalization parameters
# From file: '{data_root}/annotations/joint3d_rel_stats.pkl'
joint_3d_normalize_param = dict(
    mean=[[ 7.30826293e-03, -5.91554692e-01, -1.33610234e-01],
       [ 7.75435151e-03, -6.20348236e-01, -1.40094868e-01],
       [ 7.58494538e-03, -6.17111719e-01, -1.39288775e-01],
       [ 7.92005524e-03, -6.11943363e-01, -1.38056354e-01],
       [ 7.54937131e-03, -6.07502491e-01, -1.36894175e-01],
       [ 6.10699152e-03, -4.45041076e-01, -1.00490112e-01],
       [ 5.43717075e-03, -4.42878805e-01, -9.96161116e-02],
       [ 3.76351764e-03, -2.42145090e-01, -5.51146841e-02],
       [ 2.86085460e-03, -2.58240577e-01, -5.79127001e-02],
       [ 2.49468722e-03, -1.66754471e-01, -3.83950501e-02],
       [ 2.31179538e-03, -2.23055958e-01, -5.02909004e-02],
       [ 4.40651300e-04, -9.02374879e-04, -4.93087932e-04],
       [-4.04919750e-03,  3.32901473e-01,  7.42503046e-02],
       [-4.49188489e-03,  3.30839735e-01,  7.42675569e-02],
       [-8.84073515e-03,  7.13211439e-01,  1.59762993e-01],
       [-9.25218163e-03,  7.11186363e-01,  1.60001472e-01],
       [-9.84278126e-03,  7.66495578e-01,  1.71348485e-01],
       [-9.67451264e-03,  7.69197641e-01,  1.72015906e-01],
       [-9.29674342e-03,  7.53516154e-01,  1.68919764e-01],
       [-1.03236530e-02,  7.65573785e-01,  1.72040169e-01],
       [-1.02759577e-02,  7.66072443e-01,  1.72267305e-01],
       [-9.69270688e-03,  7.52634641e-01,  1.69394321e-01],
       [ 7.59744182e-03, -6.18316860e-01, -1.39416016e-01],
       [ 7.40446859e-03, -6.02344546e-01, -1.35823191e-01],
       [ 7.23251016e-03, -5.87326508e-01, -1.32440714e-01],
       [ 7.03120827e-03, -5.70496066e-01, -1.28656090e-01],
       [ 6.87228932e-03, -5.56414237e-01, -1.25498610e-01],
       [ 6.73675022e-03, -5.43789566e-01, -1.22672301e-01],
       [ 6.60389186e-03, -5.31948114e-01, -1.20033173e-01],
       [ 6.53025967e-03, -5.24200427e-01, -1.18310823e-01],
       [ 6.53855743e-03, -5.22369243e-01, -1.17922400e-01],
       [ 6.60741646e-03, -5.25280402e-01, -1.18603525e-01],
       [ 6.77496486e-03, -5.36337592e-01, -1.21112915e-01],
       [ 6.93474630e-03, -5.47194482e-01, -1.23564270e-01],
       [ 7.14900901e-03, -5.62787263e-01, -1.27085248e-01],
       [ 7.34805447e-03, -5.77809320e-01, -1.30475199e-01],
       [ 7.53493045e-03, -5.92350912e-01, -1.33755005e-01],
       [ 7.72560827e-03, -6.07574438e-01, -1.37185975e-01],
       [ 7.94537178e-03, -6.25453972e-01, -1.41212973e-01],
       [ 7.71148488e-03, -6.29365338e-01, -1.42016802e-01],
       [ 7.78539488e-03, -6.34335587e-01, -1.43156134e-01],
       [ 7.79742690e-03, -6.34943275e-01, -1.43310297e-01],
       [ 7.78681707e-03, -6.32935282e-01, -1.42880027e-01],
       [ 7.79895917e-03, -6.33264430e-01, -1.42969138e-01],
       [ 7.86321062e-03, -6.34637988e-01, -1.43308195e-01],
       [ 7.91497526e-03, -6.36872144e-01, -1.43816143e-01],
       [ 7.95147669e-03, -6.37577433e-01, -1.43977568e-01],
       [ 7.98296992e-03, -6.37835481e-01, -1.44038339e-01],
       [ 7.97653440e-03, -6.35655197e-01, -1.43550079e-01],
       [ 7.63208956e-03, -6.17735620e-01, -1.39492041e-01],
       [ 7.49693250e-03, -6.07177825e-01, -1.37123488e-01],
       [ 7.36580067e-03, -5.97452266e-01, -1.34942167e-01],
       [ 7.23725332e-03, -5.87578366e-01, -1.32731911e-01],
       [ 7.13564054e-03, -5.79103317e-01, -1.30774554e-01],
       [ 7.13641647e-03, -5.78574854e-01, -1.30664170e-01],
       [ 7.14115876e-03, -5.77546199e-01, -1.30442794e-01],
       [ 7.14880430e-03, -5.77488164e-01, -1.30439105e-01],
       [ 7.21309564e-03, -5.81152927e-01, -1.31270927e-01],
       [ 7.54582699e-03, -6.14995662e-01, -1.38791833e-01],
       [ 7.57125958e-03, -6.16452509e-01, -1.39135652e-01],
       [ 7.61981807e-03, -6.19143019e-01, -1.39757657e-01],
       [ 7.59241695e-03, -6.15819295e-01, -1.39022424e-01],
       [ 7.53020282e-03, -6.12030815e-01, -1.38154849e-01],
       [ 7.51904834e-03, -6.11766330e-01, -1.38081470e-01],
       [ 7.67315513e-03, -6.17408732e-01, -1.39420896e-01],
       [ 7.73576377e-03, -6.20929035e-01, -1.40219013e-01],
       [ 7.73991045e-03, -6.19697163e-01, -1.39948725e-01],
       [ 7.74624218e-03, -6.18848587e-01, -1.39761513e-01],
       [ 7.70997152e-03, -6.17240452e-01, -1.39395160e-01],
       [ 7.67703219e-03, -6.16124017e-01, -1.39138320e-01],
       [ 6.88800252e-03, -5.58573305e-01, -1.26112159e-01],
       [ 6.93516073e-03, -5.61605164e-01, -1.26818352e-01],
       [ 6.97137080e-03, -5.64251234e-01, -1.27440986e-01],
       [ 6.98218568e-03, -5.64492982e-01, -1.27502175e-01],
       [ 6.97611696e-03, -5.63259249e-01, -1.27229974e-01],
       [ 6.98721728e-03, -5.61732876e-01, -1.26881925e-01],
       [ 7.00273946e-03, -5.60317976e-01, -1.26557869e-01],
       [ 6.93226202e-03, -5.56264863e-01, -1.25640557e-01],
       [ 6.86533972e-03, -5.52317941e-01, -1.24752532e-01],
       [ 6.81994397e-03, -5.50325035e-01, -1.24297910e-01],
       [ 6.81505058e-03, -5.50980937e-01, -1.24434489e-01],
       [ 6.86207615e-03, -5.55425544e-01, -1.25414303e-01],
       [ 6.88472071e-03, -5.58155659e-01, -1.26019715e-01],
       [ 6.90853442e-03, -5.58634379e-01, -1.26153519e-01],
       [ 6.93291972e-03, -5.60092551e-01, -1.26502317e-01],
       [ 6.98317709e-03, -5.61462045e-01, -1.26813738e-01],
       [ 6.99246549e-03, -5.60327384e-01, -1.26559373e-01],
       [ 6.94570725e-03, -5.58024970e-01, -1.26035668e-01],
       [ 6.89894156e-03, -5.56810036e-01, -1.25760882e-01],
       [ 6.89113173e-03, -5.57109927e-01, -1.25804419e-01],
       [ 2.38205398e-03, -1.60331004e-01, -3.69560035e-02],
       [ 2.26557976e-03, -1.55067459e-01, -3.57740264e-02],
       [ 2.16360620e-03, -1.51435429e-01, -3.49614600e-02],
       [ 2.03518914e-03, -1.43955101e-01, -3.32986366e-02],
       [ 1.88072699e-03, -1.33269416e-01, -3.09101505e-02],
       [ 2.07648238e-03, -1.45653882e-01, -3.37258544e-02],
       [ 1.89312334e-03, -1.33365483e-01, -3.09814306e-02],
       [ 1.76809260e-03, -1.24588781e-01, -2.90072717e-02],
       [ 1.71287454e-03, -1.20576215e-01, -2.80997683e-02],
       [ 2.02868751e-03, -1.39727659e-01, -3.24138916e-02],
       [ 1.82203988e-03, -1.25888165e-01, -2.93136012e-02],
       [ 1.72181425e-03, -1.18631012e-01, -2.76766426e-02],
       [ 1.67559872e-03, -1.14951135e-01, -2.68410627e-02],
       [ 1.96571530e-03, -1.32864421e-01, -3.08763067e-02],
       [ 1.77981396e-03, -1.19806834e-01, -2.79510219e-02],
       [ 1.69906062e-03, -1.14195517e-01, -2.66815858e-02],
       [ 1.64938827e-03, -1.10382556e-01, -2.58162987e-02],
       [ 1.90669674e-03, -1.25711387e-01, -2.92685577e-02],
       [ 1.78075685e-03, -1.17332692e-01, -2.73926936e-02],
       [ 1.73210410e-03, -1.13892516e-01, -2.66139742e-02],
       [ 1.67363104e-03, -1.10133200e-01, -2.57612282e-02],
       [ 2.28051021e-03, -2.19716843e-01, -4.95638141e-02],
       [ 2.24988937e-03, -2.18608510e-01, -4.93630689e-02],
       [ 2.24593837e-03, -2.19503942e-01, -4.96075234e-02],
       [ 2.16372672e-03, -2.14830088e-01, -4.85980971e-02],
       [ 2.05428048e-03, -2.07137159e-01, -4.68993469e-02],
       [ 2.15593977e-03, -2.16089656e-01, -4.88562798e-02],
       [ 2.03198038e-03, -2.07442899e-01, -4.69521218e-02],
       [ 1.94025208e-03, -1.99714782e-01, -4.52288885e-02],
       [ 1.91042222e-03, -1.96543182e-01, -4.45305527e-02],
       [ 2.07545829e-03, -2.10009691e-01, -4.74781462e-02],
       [ 1.93612041e-03, -1.99411782e-01, -4.51320379e-02],
       [ 1.86748360e-03, -1.92898057e-01, -4.36811426e-02],
       [ 1.82843475e-03, -1.89304586e-01, -4.28855097e-02],
       [ 1.99008844e-03, -2.02476105e-01, -4.57683682e-02],
       [ 1.85335490e-03, -1.92282706e-01, -4.35125399e-02],
       [ 1.79854641e-03, -1.86928329e-01, -4.23175685e-02],
       [ 1.76081146e-03, -1.83038116e-01, -4.14505159e-02],
       [ 1.90171265e-03, -1.94984271e-01, -4.40677180e-02],
       [ 1.82110625e-03, -1.88528972e-01, -4.26399546e-02],
       [ 1.78708028e-03, -1.85139534e-01, -4.18884270e-02],
       [ 1.75041058e-03, -1.81215100e-01, -4.10089904e-02]],
    std=[[0.14693468, 0.08167124, 0.17680172],
       [0.15625464, 0.07975064, 0.17360712],
       [0.12722378, 0.0783718 , 0.16247889],
       [0.16703132, 0.06428576, 0.14499426],
       [0.08981448, 0.06026909, 0.1113382 ],
       [0.22153892, 0.05673949, 0.15292036],
       [0.06901939, 0.05002861, 0.08642725],
       [0.30983514, 0.10904041, 0.21333195],
       [0.16167776, 0.12371812, 0.16107622],
       [0.32844811, 0.20274178, 0.24940696],
       [0.20856685, 0.22440528, 0.22122479],
       [0.17280296, 0.02543298, 0.1088974 ],
       [0.20665668, 0.14186507, 0.21452863],
       [0.10075138, 0.14028811, 0.18761491],
       [0.21030873, 0.15802156, 0.23053609],
       [0.12980587, 0.15714369, 0.19724573],
       [0.25413429, 0.16244477, 0.2980474 ],
       [0.26930862, 0.159723  , 0.28449972],
       [0.20312774, 0.15971774, 0.22582872],
       [0.17820004, 0.15943084, 0.26835915],
       [0.17205533, 0.15648129, 0.24853778],
       [0.13185382, 0.15858529, 0.19405607],
       [0.10199037, 0.07265947, 0.14084357],
       [0.100962  , 0.0725058 , 0.1397881 ],
       [0.10005324, 0.07183136, 0.1375297 ],
       [0.09965887, 0.07137069, 0.13644527],
       [0.10111022, 0.07100059, 0.13576415],
       [0.10432219, 0.07084405, 0.13550891],
       [0.10992706, 0.07126484, 0.1379119 ],
       [0.11678223, 0.0715808 , 0.13929535],
       [0.1262988 , 0.07202249, 0.14213313],
       [0.13807192, 0.07269989, 0.14672395],
       [0.14860168, 0.07337952, 0.15146912],
       [0.15569095, 0.07362033, 0.15359398],
       [0.16285277, 0.07426346, 0.15681126],
       [0.16743633, 0.07504829, 0.15949803],
       [0.17019389, 0.07570229, 0.16149946],
       [0.17184659, 0.07588469, 0.16280689],
       [0.17239669, 0.07635686, 0.16374415],
       [0.12071212, 0.07887857, 0.15951647],
       [0.12536952, 0.07988897, 0.1623945 ],
       [0.12904226, 0.08054793, 0.16539587],
       [0.13455173, 0.08132802, 0.1686765 ],
       [0.13853901, 0.08174508, 0.17157377],
       [0.14921705, 0.08240474, 0.1753058 ],
       [0.15302678, 0.08223951, 0.17502887],
       [0.15723404, 0.08188619, 0.17426246],
       [0.16142322, 0.08154174, 0.17388112],
       [0.16529907, 0.08104322, 0.17365651],
       [0.1439393 , 0.08069597, 0.17355145],
       [0.14558382, 0.08150701, 0.17576213],
       [0.1464358 , 0.08239834, 0.17824767],
       [0.14906264, 0.08334169, 0.18181073],
       [0.13649937, 0.08018204, 0.16974944],
       [0.13939836, 0.08046722, 0.17118318],
       [0.14284821, 0.08050591, 0.17215844],
       [0.14623964, 0.08077277, 0.17323327],
       [0.15097509, 0.0807981 , 0.17381101],
       [0.12213938, 0.07797255, 0.15947884],
       [0.12559723, 0.0787232 , 0.1621447 ],
       [0.12996564, 0.0791755 , 0.1644635 ],
       [0.13384018, 0.07887846, 0.16602068],
       [0.12961168, 0.07868952, 0.1635566 ],
       [0.12602589, 0.07825057, 0.1615361 ],
       [0.14897426, 0.08000429, 0.17068454],
       [0.15233194, 0.08037046, 0.17115409],
       [0.15668868, 0.08044305, 0.17187252],
       [0.15990411, 0.07991826, 0.17243085],
       [0.15658178, 0.07990385, 0.17185663],
       [0.1528099 , 0.07983899, 0.17124448],
       [0.12644232, 0.07673707, 0.15855034],
       [0.13269208, 0.07855262, 0.16349956],
       [0.13975007, 0.07976774, 0.1694041 ],
       [0.14224615, 0.08011197, 0.17061265],
       [0.14455242, 0.08028257, 0.17172332],
       [0.14683246, 0.07920362, 0.16853542],
       [0.14905029, 0.07819164, 0.16524106],
       [0.14547535, 0.07779892, 0.16543691],
       [0.14309274, 0.07802395, 0.16607933],
       [0.13935245, 0.07816858, 0.16639304],
       [0.13510424, 0.07771896, 0.16454693],
       [0.13015142, 0.07700079, 0.16039396],
       [0.12672008, 0.07692352, 0.15849978],
       [0.13434216, 0.07815674, 0.1635873 ],
       [0.14031154, 0.07950793, 0.16840031],
       [0.14457702, 0.07903068, 0.16667433],
       [0.14732407, 0.07806738, 0.16520431],
       [0.14395744, 0.07797916, 0.1654123 ],
       [0.1398628 , 0.07834498, 0.16730548],
       [0.13319767, 0.07748597, 0.16237594],
       [0.3310902 , 0.21320448, 0.25567474],
       [0.32740201, 0.22529579, 0.25692204],
       [0.32431861, 0.23823979, 0.26015624],
       [0.32780055, 0.25042677, 0.2666064 ],
       [0.3305096 , 0.26129466, 0.27146132],
       [0.3423964 , 0.2529767 , 0.27761018],
       [0.34569748, 0.26521558, 0.28357111],
       [0.34456421, 0.27035511, 0.28476036],
       [0.34344695, 0.27322342, 0.28479969],
       [0.34945274, 0.25257214, 0.28082229],
       [0.3507808 , 0.26434412, 0.28574824],
       [0.3486048 , 0.26793174, 0.2853671 ],
       [0.34685154, 0.27036548, 0.28447694],
       [0.35247114, 0.25042457, 0.28130516],
       [0.35406651, 0.26081219, 0.28510632],
       [0.35118172, 0.2633585 , 0.28452555],
       [0.34884668, 0.26524798, 0.28347402],
       [0.35488673, 0.24657584, 0.28021215],
       [0.35565653, 0.25397428, 0.28332204],
       [0.35373977, 0.25635978, 0.28257521],
       [0.35078095, 0.25802041, 0.28195943],
       [0.21433975, 0.23426741, 0.22777159],
       [0.21837464, 0.24671416, 0.23471245],
       [0.22352809, 0.25944597, 0.24326147],
       [0.23185471, 0.27245224, 0.25410764],
       [0.23944997, 0.28401777, 0.26321829],
       [0.24079469, 0.2757846 , 0.26057179],
       [0.24903121, 0.28866104, 0.27080685],
       [0.25204584, 0.29439129, 0.27456278],
       [0.25412171, 0.29769063, 0.27687621],
       [0.24381585, 0.27608306, 0.261784  ],
       [0.25122834, 0.28841446, 0.27108255],
       [0.25308671, 0.29240166, 0.27323947],
       [0.25417703, 0.29535716, 0.27492634],
       [0.2439463 , 0.2738679 , 0.26033178],
       [0.25053061, 0.28505189, 0.26885395],
       [0.25199201, 0.28767538, 0.27038448],
       [0.25262569, 0.2898359 , 0.271649  ],
       [0.24329813, 0.2696246 , 0.2585625 ],
       [0.2480316 , 0.27775457, 0.26429794],
       [0.24899416, 0.28015168, 0.26564705],
       [0.24946748, 0.28227271, 0.26642724]])

# 2D joint normalization parameters
# From file: '{data_root}/annotations/joint2d_stats.pkl'
joint_2d_normalize_param = dict(
    mean=[[537.86366476, 274.72341024],
       [538.1932465 , 267.70031816],
       [537.59537973, 268.39129848],
       [538.28075123, 269.97504486],
       [537.07592461, 270.80948129],
       [537.7418793 , 310.82859537],
       [535.64816885, 310.97836433],
       [537.20229894, 359.44873687],
       [534.22419403, 355.29109886],
       [537.20570859, 377.12434049],
       [534.3937687 , 363.47234316],
       [535.30477118, 415.81671133],
       [534.03047714, 416.06524468],
       [534.9281039 , 492.64959733],
       [532.9747506 , 492.51100934],
       [532.90338803, 576.78355853],
       [531.54909992, 576.87212007],
       [533.56692915, 588.95513987],
       [533.65039025, 589.21284974],
       [532.47219793, 585.468885  ],
       [531.52146222, 589.35963141],
       [531.06593207, 589.46362616],
       [531.3871354 , 585.76267864],
       [536.97122578, 268.05643671],
       [536.9237771 , 271.99545568],
       [536.89893762, 275.69977354],
       [536.86470079, 279.83996499],
       [536.89775985, 283.3067373 ],
       [536.96194958, 286.41465622],
       [537.05153421, 289.32563622],
       [537.18038299, 291.23936684],
       [537.35830235, 291.71179205],
       [537.56942711, 291.02912031],
       [537.78714462, 288.35352693],
       [537.93595919, 285.71966981],
       [538.1075237 , 281.92337079],
       [538.23719834, 278.25344284],
       [538.33891091, 274.69275667],
       [538.42268205, 270.95661904],
       [538.50801145, 266.55874048],
       [537.40326821, 265.33827774],
       [537.54057531, 264.12581316],
       [537.62406883, 263.9834025 ],
       [537.74596531, 264.49470818],
       [537.83442584, 264.42459536],
       [538.09077029, 264.12862633],
       [538.18811206, 263.59887273],
       [538.28064828, 263.44957819],
       [538.36403208, 263.40779265],
       [538.42878437, 263.96476069],
       [537.91092959, 268.28007316],
       [537.88235226, 270.8780392 ],
       [537.84415335, 273.26554415],
       [537.83786527, 275.69154132],
       [537.58959622, 277.76395305],
       [537.65368854, 277.90273363],
       [537.73983789, 278.16816518],
       [537.81569689, 278.19142071],
       [537.93033823, 277.30872569],
       [537.42475652, 268.89726768],
       [537.50524702, 268.5453585 ],
       [537.61999702, 267.89572456],
       [537.70552194, 268.73141799],
       [537.59313855, 269.65178835],
       [537.51025358, 269.70607648],
       [538.04695683, 268.39558249],
       [538.13560891, 267.54339985],
       [538.21269261, 267.86383153],
       [538.27541031, 268.08780816],
       [538.20575392, 268.4700542 ],
       [538.12262616, 268.72932886],
       [537.37912522, 282.80123454],
       [537.49885303, 282.06580154],
       [537.63596075, 281.42517669],
       [537.68527007, 281.37382133],
       [537.73108009, 281.68275335],
       [537.79900237, 282.07829147],
       [537.85590812, 282.44592516],
       [537.76629317, 283.42488613],
       [537.69943037, 284.38020149],
       [537.60090436, 284.8533731 ],
       [537.51671369, 284.67990918],
       [537.44278834, 283.58406578],
       [537.38914266, 282.90508786],
       [537.53579699, 282.80200562],
       [537.64315242, 282.45428903],
       [537.7542278 , 282.14097573],
       [537.8256139 , 282.43688385],
       [537.73811432, 282.987541  ],
       [537.63414756, 283.2637315 ],
       [537.51257655, 283.17830549],
       [537.17771188, 378.62842602],
       [537.11320122, 379.81811799],
       [537.05846506, 380.62222982],
       [537.03423538, 382.34471781],
       [536.96701051, 384.82098769],
       [537.20970292, 381.97976525],
       [537.14822617, 384.82871118],
       [537.05897568, 386.86609646],
       [536.99105871, 387.79024683],
       [537.24170622, 383.38765485],
       [537.13878578, 386.59931101],
       [537.04227566, 388.27978434],
       [536.98387847, 389.1209448 ],
       [537.21406292, 385.0153305 ],
       [537.12908073, 388.04278236],
       [537.04194028, 389.3407462 ],
       [536.96744196, 390.21751562],
       [537.17429975, 386.7082137 ],
       [537.11757782, 388.65210893],
       [537.06148509, 389.44165403],
       [536.99058846, 390.30840933],
       [534.39510799, 364.25681917],
       [534.4933386 , 364.46391216],
       [534.58987611, 364.20328317],
       [534.64678549, 365.26259269],
       [534.6834311 , 367.04525486],
       [534.50283717, 364.98623415],
       [534.55402435, 366.98962615],
       [534.58710392, 368.79223115],
       [534.6407263 , 369.51561666],
       [534.43697941, 366.43346887],
       [534.48989301, 368.90070871],
       [534.53120039, 370.41464728],
       [534.58225603, 371.23242017],
       [534.37137678, 368.23661734],
       [534.43032743, 370.60772338],
       [534.46898805, 371.85364785],
       [534.50318501, 372.75212922],
       [534.32161689, 370.03645283],
       [534.36595246, 371.53353072],
       [534.41184416, 372.31567971],
       [534.42406108, 373.22573619]],
    std=[[101.67127659,  57.25374246],
       [100.46790251,  57.6319743 ],
       [103.86591017,  57.66317539],
       [ 98.74171457,  56.50981104],
       [107.0222862 ,  56.72249889],
       [ 96.87798059,  52.91421368],
       [114.45551744,  53.36231971],
       [ 99.37887021,  55.94132102],
       [127.00589781,  58.96965229],
       [101.7063113 ,  67.34878119],
       [128.54919768,  73.45864342],
       [ 95.85638518,  47.21738245],
       [108.33827623,  47.41548444],
       [100.30782639,  43.10121808],
       [110.40126528,  43.62703338],
       [102.99067186,  50.39087227],
       [111.80010231,  52.13738756],
       [103.53227537,  51.7706836 ],
       [102.80298566,  51.19201958],
       [103.84026609,  51.53965411],
       [112.69958285,  53.80829198],
       [116.15619428,  54.00611491],
       [111.78637547,  53.28889042],
       [107.9095756 ,  57.64879518],
       [107.55233252,  57.36454761],
       [106.97108552,  57.08035262],
       [106.52257662,  56.76922049],
       [105.61257852,  56.50335412],
       [104.54195281,  56.26751822],
       [103.48457266,  56.06782615],
       [102.34596641,  55.93950022],
       [101.16895568,  55.89690226],
       [100.08605648,  55.93129365],
       [ 99.3262612 ,  56.08671216],
       [ 98.92846511,  56.26437853],
       [ 98.6390713 ,  56.51489378],
       [ 98.54774233,  56.79509489],
       [ 98.58251617,  57.03945826],
       [ 98.68094174,  57.26739411],
       [ 98.82812502,  57.58231265],
       [105.43753758,  58.04155674],
       [104.73167056,  58.14968413],
       [104.29058401,  58.17374035],
       [103.55346916,  58.1493702 ],
       [103.09720318,  58.11646267],
       [101.70835868,  58.12310349],
       [101.22147676,  58.1370001 ],
       [100.69252257,  58.11690173],
       [100.24007882,  58.08298537],
       [ 99.845984  ,  58.01130031],
       [102.16292548,  57.67226496],
       [102.01805817,  57.52297454],
       [102.04906238,  57.41365798],
       [101.87924306,  57.26076228],
       [102.5844014 ,  57.05283191],
       [102.18768244,  57.03633571],
       [101.70695054,  57.00709181],
       [101.33336181,  57.02113087],
       [100.80560766,  57.05813117],
       [104.7104335 ,  57.68156469],
       [104.33070945,  57.71994525],
       [103.66863553,  57.76325362],
       [103.06778074,  57.6246488 ],
       [103.60209015,  57.60616403],
       [104.07483592,  57.60620517],
       [101.22190047,  57.6585382 ],
       [100.85856374,  57.73360952],
       [100.43096946,  57.71209761],
       [100.11284735,  57.63300923],
       [100.40477402,  57.61593107],
       [100.79673951,  57.60520857],
       [102.81328151,  56.56779239],
       [102.29106521,  56.70970973],
       [101.77281969,  56.7569193 ],
       [101.51649466,  56.76283055],
       [101.25317875,  56.74771399],
       [100.68465722,  56.66036668],
       [100.16797381,  56.61448291],
       [100.54992835,  56.49170228],
       [100.8648893 ,  56.42741181],
       [101.37844966,  56.4002288 ],
       [101.84297426,  56.41329632],
       [102.31666511,  56.49838662],
       [102.74424204,  56.58591078],
       [101.97862846,  56.61622809],
       [101.51481315,  56.68166662],
       [100.82050557,  56.69229978],
       [100.37244208,  56.59444766],
       [100.75114425,  56.52912048],
       [101.42684261,  56.50075367],
       [102.02509754,  56.52104261],
       [102.24106577,  68.92682377],
       [102.45413563,  71.03556404],
       [102.76944623,  73.31745501],
       [103.51769479,  75.47357773],
       [104.2056635 ,  77.4878276 ],
       [104.36893097,  75.55384741],
       [105.16485552,  77.83154289],
       [105.5021098 ,  78.94510738],
       [105.76050722,  79.67587943],
       [104.79733647,  75.40271548],
       [105.514887  ,  77.66050142],
       [105.74932083,  78.55475595],
       [105.90770959,  79.22544463],
       [104.93111983,  75.0206518 ],
       [105.55008599,  77.00859821],
       [105.71786091,  77.69075484],
       [105.82888526,  78.2462793 ],
       [104.97466661,  74.35977823],
       [105.43456715,  75.76167864],
       [105.52902567,  76.35929672],
       [105.56853451,  76.82536375],
       [128.81592638,  75.12171169],
       [128.1384109 ,  77.35841358],
       [127.73455312,  79.68801433],
       [127.88663746,  82.10860454],
       [128.14003232,  84.30004735],
       [130.33338753,  82.59647594],
       [130.49162679,  85.05207275],
       [130.29975398,  86.22462966],
       [129.96267062,  86.95770314],
       [131.12536778,  82.63172133],
       [131.14352892,  85.01801221],
       [130.76468123,  85.8797951 ],
       [130.25454323,  86.55113112],
       [131.55500054,  82.19627789],
       [131.45910056,  84.3471309 ],
       [131.07592095,  84.94891121],
       [130.71074298,  85.46381101],
       [131.76341848,  81.36914561],
       [131.74181651,  82.94548306],
       [131.37058021,  83.47086548],
       [131.15626107,  83.9599305 ]])

train_pipeline = [
    dict(
        type='GetRootCenteredPose',
        item='target',
        visible_item='target_visible',
        root_index=12,
        root_name='root_position',
        remove_root=True),
    dict(
        type='NormalizeJointCoordinate',
        item='target',
        mean=joint_3d_normalize_param['mean'],
        std=joint_3d_normalize_param['std']),
    dict(
        type='NormalizeJointCoordinate',
        item='input_2d',
        mean=joint_2d_normalize_param['mean'],
        std=joint_2d_normalize_param['std']),
    dict(type='PoseSequenceToTensor', item='input_2d'),
    dict(
        type='Collect',
        keys=[('input_2d', 'input'), 'target'],
        meta_name='metas',
        meta_keys=[
            'target_image_path', 'flip_pairs', 'root_position',
            'root_position_index', 'target_mean', 'target_std'
        ])
]

val_pipeline = train_pipeline
test_pipeline = val_pipeline

data = dict(
    samples_per_gpu=64,
    workers_per_gpu=2,
    val_dataloader=dict(samples_per_gpu=64),
    test_dataloader=dict(samples_per_gpu=64),
    train=dict(
        type='WholeBody3DH3WBDataset',
        ann_file=f'{data_root}/annotations/h3wb_train.npz',
        img_prefix=f'{data_root}/images/',
        data_cfg=data_cfg,
        pipeline=train_pipeline,
        dataset_info={{_base_.dataset_info}}),
    val=dict(
        type='WholeBody3DH3WBDataset',
        ann_file=f'{data_root}/annotations/h3wb_test_valid.npz',
        img_prefix=f'{data_root}/images/',
        data_cfg=data_cfg,
        pipeline=val_pipeline,
        dataset_info={{_base_.dataset_info}}),
    test=dict(
        type='WholeBody3DH3WBDataset',
        ann_file=f'{data_root}/annotations/h3wb_test_valid.npz',
        img_prefix=f'{data_root}/images/',
        data_cfg=data_cfg,
        pipeline=test_pipeline,
        dataset_info={{_base_.dataset_info}}),
)
